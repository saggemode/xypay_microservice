<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XyPay Teller Check Cashing Console</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .java-window { font-family: 'Segoe UI', sans-serif; font-size: 12px; background: #f0f0f0; border: 2px outset #c0c0c0; }
        .title-bar { background: linear-gradient(to bottom, #0078d4, #106ebe); color: white; padding: 4px 8px; font-weight: bold; display: flex; justify-content: space-between; }
        .window-btn { width: 16px; height: 14px; background: #c0c0c0; border: 1px outset #c0c0c0; text-align: center; line-height: 12px; cursor: pointer; font-size: 10px; }
        .menu-bar { background: #f0f0f0; border-bottom: 1px solid #c0c0c0; padding: 2px; display: flex; gap: 16px; }
        .menu-item { padding: 4px 8px; cursor: pointer; } .menu-item:hover { background: #e0e0e0; }
        .toolbar { background: #f0f0f0; border-bottom: 1px solid #c0c0c0; padding: 4px; display: flex; gap: 4px; }
        .toolbar-btn { padding: 4px 8px; background: #e8e8e8; border: 1px outset #c0c0c0; cursor: pointer; font-size: 11px; }
        .toolbar-separator { width: 1px; height: 20px; background: #c0c0c0; margin: 0 4px; }
        .content-area { display: flex; height: calc(100vh - 120px); }
        .tree-panel { width: 250px; background: #f8f8f8; border-right: 1px solid #c0c0c0; overflow-y: auto; }
        .tree-header { background: #e0e0e0; padding: 6px; font-weight: bold; border-bottom: 1px solid #c0c0c0; }
        .tree-node { padding: 6px 12px; cursor: pointer; display: flex; align-items: center; gap: 8px; border-bottom: 1px solid #f0f0f0; }
        .tree-node:hover { background: #e8e8e8; } .tree-node.selected { background: #316ac5; color: white; }
        .tree-icon { font-size: 14px; }
        .details-panel { flex: 1; background: white; overflow-y: auto; }
        .details-header { background: #e0e0e0; padding: 8px; font-weight: bold; border-bottom: 1px solid #c0c0c0; }
        .details-content { padding: 16px; }
        .config-section { border: 1px solid #c0c0c0; margin-bottom: 16px; }
        .config-header { background: #e8e8e8; padding: 6px 12px; font-weight: bold; border-bottom: 1px solid #c0c0c0; }
        .config-content { padding: 12px; }
        .java-btn { padding: 4px 12px; background: #e8e8e8; border: 1px outset #c0c0c0; cursor: pointer; font-size: 11px; }
        .java-btn:hover { background: #d0d0d0; }
        .java-btn.primary { background: #0078d4; color: white; border: 1px outset #0078d4; }
        .java-btn.danger { background: #d13212; color: white; border: 1px outset #d13212; }
        .status-bar { background: #f0f0f0; border-top: 1px solid #c0c0c0; padding: 4px 8px; font-size: 11px; display: flex; justify-content: space-between; }
        fieldset { border: 1px inset #c0c0c0; padding: 12px; margin-bottom: 16px; background: #f8f8f8; }
        legend { font-weight: bold; font-size: 12px; padding: 0 4px; }
        .form-row { display: flex; align-items: center; margin-bottom: 8px; }
        .form-label { width: 140px; font-weight: bold; font-size: 11px; }
        .form-input { padding: 2px 4px; border: 1px inset #c0c0c0; font-size: 11px; background: white; flex: 1; margin-right: 8px; }
        .form-select { padding: 2px 4px; border: 1px inset #c0c0c0; font-size: 11px; background: white; flex: 1; margin-right: 8px; }
        .java-alert { padding: 8px; border: 1px solid #c0c0c0; margin-bottom: 12px; }
        .java-alert.success { background: #d4edda; border-color: #c3e6cb; color: #155724; }
        .java-alert.warning { background: #fff3cd; border-color: #ffeaa7; color: #856404; }
        .java-alert.danger { background: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .check-preview { border: 2px solid #333; padding: 16px; background: #fffef7; font-family: 'Courier New', monospace; margin: 12px 0; }
        .check-amount { font-size: 16px; font-weight: bold; color: #d13212; }
    </style>
</head>
<body class="bg-gray-100">
    <div class="java-window min-h-screen">
        <!-- Title Bar -->
        <div class="title-bar">
            <span>XyPay Teller Console - Check Cashing Service</span>
            <div class="flex gap-1">
                <div class="window-btn">_</div>
                <div class="window-btn">‚ñ°</div>
                <div class="window-btn">√ó</div>
            </div>
        </div>
        
        <!-- Menu Bar -->
        <div class="menu-bar">
            <span class="menu-item">File</span>
            <span class="menu-item">Transaction</span>
            <span class="menu-item">Check</span>
            <span class="menu-item">Verification</span>
            <span class="menu-item">Reports</span>
            <span class="menu-item">Help</span>
        </div>
        
        <!-- Toolbar -->
        <div class="toolbar">
            <button class="toolbar-btn" onclick="newCheckCashing()">New Check</button>
            <button class="toolbar-btn" onclick="verifyCheck()">Verify Check</button>
            <button class="toolbar-btn" onclick="scanCheck()">Scan Check</button>
            <div class="toolbar-separator"></div>
            <button class="toolbar-btn" onclick="printReceipt()">Print Receipt</button>
            <button class="toolbar-btn" onclick="showHistory()">Cashing History</button>
            <div class="toolbar-separator"></div>
            <button class="toolbar-btn">Help</button>
        </div>
        
        <!-- Main Content Area -->
        <div class="content-area">
            <!-- Left Navigation Panel -->
            <div class="tree-panel">
                <div class="tree-header">Check Services</div>
                
                <div class="tree-node selected" onclick="selectService(this, 'personal-check')">
                    <div class="tree-icon">üìÑ</div>
                    Personal Check
                </div>
                
                <div class="tree-node" onclick="selectService(this, 'business-check')">
                    <div class="tree-icon">üè¢</div>
                    Business Check
                </div>
                
                <div class="tree-node" onclick="selectService(this, 'cashiers-check')">
                    <div class="tree-icon">üè¶</div>
                    Cashier's Check
                </div>
                
                <div class="tree-node" onclick="selectService(this, 'money-order')">
                    <div class="tree-icon">üí∞</div>
                    Money Order
                </div>
                
                <div class="tree-node" onclick="selectService(this, 'travelers-check')">
                    <div class="tree-icon">‚úàÔ∏è</div>
                    Traveler's Check
                </div>
                
                <div class="tree-node" onclick="selectService(this, 'check-history')">
                    <div class="tree-icon">üìã</div>
                    Cashing History
                </div>
            </div>
            
            <!-- Right Details Panel -->
            <div class="details-panel">
                <div class="details-header">Check Cashing Transaction</div>
                <div class="details-content">
                    
                    <div class="config-section">
                        <div class="config-header">üìÑ Check Cashing Processing</div>
                        <div class="config-content">
                            
                            <!-- Result Messages -->
                            <div th:if="${result}" class="java-alert success">
                                <strong>‚úÖ Transaction Result:</strong><br>
                                <span th:text="${result}">Check cashed successfully</span>
                            </div>
                            
                            <form th:action="@{/teller/check-cashing}" method="post">
                                <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                                
                                <!-- Check Information Section -->
                                <fieldset>
                                    <legend>üìÑ Check Information</legend>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Check Type:</span>
                                        <select class="form-select" id="checkType" name="checkType" onchange="updateCheckFields()">
                                            <option value="PERSONAL">Personal Check</option>
                                            <option value="BUSINESS">Business Check</option>
                                            <option value="CASHIERS">Cashier's Check</option>
                                            <option value="MONEY_ORDER">Money Order</option>
                                            <option value="TRAVELERS">Traveler's Check</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Check Number:</span>
                                        <input type="text" class="form-input" id="checkNumber" name="checkNumber" required placeholder="Check number">
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Check Amount:</span>
                                        <input type="number" step="0.01" class="form-input" id="checkAmount" name="checkAmount" required placeholder="0.00" onchange="updateCheckPreview()">
                                    </div>
                                    <div style="font-size: 10px; color: #666; margin-bottom: 12px;">Amount written on the check</div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Check Date:</span>
                                        <input type="date" class="form-input" id="checkDate" name="checkDate" required>
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Routing Number:</span>
                                        <input type="text" class="form-input" id="routingNumber" name="routingNumber" placeholder="9-digit routing number">
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Account Number:</span>
                                        <input type="text" class="form-input" id="accountNumber" name="accountNumber" placeholder="Account number">
                                    </div>
                                    
                                    <div style="text-align: center; margin: 12px 0;">
                                        <button type="button" class="java-btn" onclick="verifyCheck()">Verify Check</button>
                                        <button type="button" class="java-btn" onclick="scanCheck()">Scan Check</button>
                                    </div>
                                </fieldset>
                                
                                <!-- Check Preview -->
                                <fieldset>
                                    <legend>üëÅÔ∏è Check Preview</legend>
                                    <div class="check-preview" id="checkPreview">
                                        <div style="text-align: right; margin-bottom: 8px;">
                                            <strong>Date:</strong> <span id="previewDate">____/____/____</span>
                                        </div>
                                        <div style="margin-bottom: 8px;">
                                            <strong>Pay to the Order of:</strong> XyPay Bank
                                        </div>
                                        <div style="margin-bottom: 8px;">
                                            <strong class="check-amount">$<span id="previewAmount">0.00</span></strong>
                                        </div>
                                        <div style="margin-bottom: 8px;">
                                            <strong>Memo:</strong> Check Cashing
                                        </div>
                                        <div style="text-align: right;">
                                            <strong>Check #:</strong> <span id="previewCheckNumber">______</span>
                                        </div>
                                    </div>
                                </fieldset>
                                
                                <!-- Payee Information Section -->
                                <fieldset>
                                    <legend>üë§ Payee Information</legend>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Payee Name:</span>
                                        <input type="text" class="form-input" id="payeeName" name="payeeName" required placeholder="Name on the check">
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Phone Number:</span>
                                        <input type="tel" class="form-input" id="phoneNumber" name="phoneNumber" placeholder="+234-xxx-xxx-xxxx">
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Address:</span>
                                        <textarea class="form-input" id="address" name="address" rows="2" placeholder="Payee address"></textarea>
                                    </div>
                                </fieldset>
                                
                                <!-- Customer Information Section -->
                                <fieldset>
                                    <legend>üÜî Customer Identification</legend>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Customer Name:</span>
                                        <input type="text" class="form-input" id="customerName" name="customerName" required placeholder="Name of person cashing check">
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">ID Type:</span>
                                        <select class="form-select" id="idType" name="idType" required>
                                            <option value="">Select ID Type</option>
                                            <option value="DRIVERS_LICENSE">Driver's License</option>
                                            <option value="PASSPORT">Passport</option>
                                            <option value="NATIONAL_ID">National ID</option>
                                            <option value="VOTER_ID">Voter ID</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">ID Number:</span>
                                        <input type="text" class="form-input" id="idNumber" name="idNumber" required placeholder="Identification number">
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Thumbprint:</span>
                                        <button type="button" class="java-btn" onclick="captureThumbprint()">üì± Capture Thumbprint</button>
                                    </div>
                                </fieldset>
                                
                                <!-- Transaction Options -->
                                <fieldset>
                                    <legend>‚öôÔ∏è Transaction Options</legend>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Cash Out Method:</span>
                                        <select class="form-select" id="cashOutMethod" name="cashOutMethod" onchange="updateFees()">
                                            <option value="CASH">Cash</option>
                                            <option value="ACCOUNT_CREDIT">Credit to Account</option>
                                            <option value="MONEY_ORDER">Money Order</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-row" id="accountRow" style="display: none;">
                                        <span class="form-label">Account Number:</span>
                                        <input type="text" class="form-input" id="creditAccount" name="creditAccount" placeholder="Account to credit">
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Hold Funds:</span>
                                        <select class="form-select" id="holdFunds" name="holdFunds">
                                            <option value="NO">No Hold</option>
                                            <option value="PARTIAL">Partial Hold</option>
                                            <option value="FULL">Full Hold</option>
                                        </select>
                                    </div>
                                </fieldset>
                                
                                <!-- Fee Calculation -->
                                <fieldset style="background: #f8f8f8;">
                                    <legend>üí∞ Fee Calculation</legend>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Check Amount:</span>
                                        <input type="text" class="form-input" id="summaryAmount" readonly placeholder="0.00">
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Cashing Fee:</span>
                                        <input type="text" class="form-input" id="cashingFee" value="5.00" readonly>
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Service Fee:</span>
                                        <input type="text" class="form-input" id="serviceFee" value="2.00" readonly>
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Total Fees:</span>
                                        <input type="text" class="form-input" id="totalFees" readonly placeholder="0.00">
                                    </div>
                                    
                                    <div class="form-row">
                                        <span class="form-label">Net Amount:</span>
                                        <input type="text" class="form-input" id="netAmount" readonly placeholder="0.00">
                                    </div>
                                </fieldset>
                                
                                <div style="text-align: center; margin-top: 20px;">
                                    <button type="button" class="java-btn" onclick="calculateFees()">Calculate Fees</button>
                                    <button type="submit" class="java-btn primary">üí∞ Cash Check</button>
                                    <button type="button" class="java-btn danger" onclick="rejectCheck()">‚ùå Reject Check</button>
                                    <button type="button" class="java-btn" onclick="clearForm()">Clear Form</button>
                                </div>
                            </form>
                            
                            <div th:unless="${result}" style="background: #f8f8f8; border: 1px inset #c0c0c0; padding: 12px; margin-top: 16px; font-size: 11px; color: #666;">
                                <strong>Instructions:</strong> Enter check details and verify the check. 
                                Capture customer identification and process the check cashing transaction.
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
        
        <!-- Status Bar -->
        <div class="status-bar">
            <span>Teller Console Ready | Service: Check Cashing | Session: Active</span>
            <span>Check Status: <span id="checkStatus">Ready</span></span>
        </div>
    </div>
    
    <script>
        function selectService(element, serviceType) {
            // Update tree selection
            if (element) {
                document.querySelectorAll('.tree-node').forEach(node => {
                    node.classList.remove('selected');
                });
                element.classList.add('selected');
            }
            
            // Update status
            document.getElementById('checkStatus').textContent = 'Service: ' + serviceType.replace('-', ' ').toUpperCase();
            
            // In a real application, this would load different service forms
            alert('Service selected: ' + serviceType.replace('-', ' ').toUpperCase());
        }
        
        function updateCheckFields() {
            const checkType = document.getElementById('checkType').value;
            // Different check types might have different validation rules
            document.getElementById('checkStatus').textContent = 'Check Type: ' + checkType;
        }
        
        function updateCheckPreview() {
            const amount = document.getElementById('checkAmount').value;
            const checkNumber = document.getElementById('checkNumber').value;
            const checkDate = document.getElementById('checkDate').value;
            
            document.getElementById('previewAmount').textContent = amount || '0.00';
            document.getElementById('previewCheckNumber').textContent = checkNumber || '______';
            document.getElementById('previewDate').textContent = checkDate ? new Date(checkDate).toLocaleDateString() : '____/____/____';
            
            if (amount) {
                document.getElementById('summaryAmount').value = '‚Ç¶' + parseFloat(amount).toFixed(2);
                calculateFees();
            }
        }
        
        function verifyCheck() {
            const checkNumber = document.getElementById('checkNumber').value;
            const routingNumber = document.getElementById('routingNumber').value;
            
            if (!checkNumber || !routingNumber) {
                alert('‚ùå Please enter check number and routing number first.');
                return;
            }
            
            document.getElementById('checkStatus').textContent = 'Verifying check...';
            
            setTimeout(() => {
                // Simulate check verification
                const isValid = Math.random() > 0.2; // 80% success rate
                
                if (isValid) {
                    alert('‚úÖ Check Verification Successful!\\n\\nCheck Status: Valid\\nAccount Status: Active\\nFunds Available: Yes');
                    document.getElementById('checkStatus').textContent = 'Check Verified';
                } else {
                    alert('‚ùå Check Verification Failed!\\n\\nReason: Insufficient funds or invalid check');
                    document.getElementById('checkStatus').textContent = 'Verification Failed';
                }
            }, 2000);
        }
        
        function scanCheck() {
            alert('üì± Check Scanner\\n\\nThis would activate the check scanner in a real implementation.');
            document.getElementById('checkStatus').textContent = 'Scanning check...';
        }
        
        function captureThumbprint() {
            alert('üëÜ Thumbprint Capture\\n\\nThis would capture customer thumbprint in a real implementation.');
        }
        
        function updateFees() {
            const cashOutMethod = document.getElementById('cashOutMethod').value;
            const accountRow = document.getElementById('accountRow');
            
            if (cashOutMethod === 'ACCOUNT_CREDIT') {
                accountRow.style.display = 'block';
                document.getElementById('creditAccount').required = true;
            } else {
                accountRow.style.display = 'none';
                document.getElementById('creditAccount').required = false;
            }
            
            calculateFees();
        }
        
        function calculateFees() {
            const amount = parseFloat(document.getElementById('checkAmount').value || 0);
            const cashingFee = parseFloat(document.getElementById('cashingFee').value || 0);
            const serviceFee = parseFloat(document.getElementById('serviceFee').value || 0);
            
            if (amount <= 0) {
                return;
            }
            
            const totalFees = cashingFee + serviceFee;
            const netAmount = amount - totalFees;
            
            document.getElementById('totalFees').value = '‚Ç¶' + totalFees.toFixed(2);
            document.getElementById('netAmount').value = '‚Ç¶' + netAmount.toFixed(2);
            
            document.getElementById('checkStatus').textContent = 'Fees Calculated';
        }
        
        function rejectCheck() {
            if (confirm('Reject this check cashing transaction?')) {
                alert('‚ùå Check Rejected\\n\\nTransaction has been rejected and logged.');
                clearForm();
            }
        }
        
        function clearForm() {
            if (confirm('Clear all form data?')) {
                document.querySelector('form').reset();
                document.getElementById('summaryAmount').value = '';
                document.getElementById('totalFees').value = '';
                document.getElementById('netAmount').value = '';
                document.getElementById('previewAmount').textContent = '0.00';
                document.getElementById('previewCheckNumber').textContent = '______';
                document.getElementById('previewDate').textContent = '____/____/____';
                document.getElementById('checkStatus').textContent = 'Ready';
                updateCheckFields();
                updateFees();
            }
        }
        
        function newCheckCashing() {
            clearForm();
        }
        
        function printReceipt() {
            alert('üñ®Ô∏è Print Receipt\\n\\nThis would print a check cashing receipt in a real implementation.');
        }
        
        function showHistory() {
            alert('üìã Cashing History\\n\\nThis would show check cashing history in a real implementation.');
        }
        
        // Auto-update preview when fields change
        document.getElementById('checkAmount').addEventListener('input', updateCheckPreview);
        document.getElementById('checkNumber').addEventListener('input', updateCheckPreview);
        document.getElementById('checkDate').addEventListener('change', updateCheckPreview);
        
        // Initialize
        window.onload = function() {
            document.getElementById('checkStatus').textContent = 'Ready';
            updateCheckFields();
            updateFees();
            
            // Set today's date as default
            document.getElementById('checkDate').value = new Date().toISOString().split('T')[0];
        };
    </script>
</body>
</html>
